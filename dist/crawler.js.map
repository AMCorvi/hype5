{"version":3,"sources":["crawler.js"],"names":["casper","require","create","tracks","hypeType","cli","get","hypeFilter","getTrackInfo","element","document","getElementsByClassName","cool","Array","prototype","map","call","artist","querySelector","text","trackName","postLink","getAttribute","descFunc","descUnfiltered","textContent","end","indexOf","start","result","substr","desc","color","style","cssText","blogName","link","descrip","thumbnail","song","concat","scanHype","type","filter","url","waitForSelector","info","evaluate","then","console","log","JSON","stringify","run"],"mappings":";;AAAA,IAAIA,SAASC,QAAQ,QAAR,EAAkBC,MAAlB,EAAb;;AAEA,IAAIC,SAAS,EAAb;AACA,IAAIC,WAAWJ,OAAOK,GAAP,CAAWC,GAAX,CAAe,UAAf,CAAf;AACA,IAAIC,aAAaP,OAAOK,GAAP,CAAWC,GAAX,CAAe,YAAf,CAAjB;;AAGA,SAASE,YAAT,CAAsBL,MAAtB,EAA8B;AAC7BA;AACA,KAAIM,UAAUC,SAASC,sBAAT,CAAgC,eAAhC,CAAd;AACA,KAAIC,OAAOC,MAAMC,SAAN,CAAgBC,GAAhB,CAAoBC,IAApB,CAAyBP,OAAzB,EAAkC,UAASA,OAAT,EAAkB;AAC9D,MAAIQ,SAASR,QAAQS,aAAR,CAAsB,SAAtB,EAAiCC,IAA9C;AACA,MAAIC,YAAYX,QAAQS,aAAR,CAAsB,QAAtB,EAAgCC,IAAhD;AACA,MAAIE,WAAWZ,QAAQS,aAAR,CAAsB,WAAtB,EAAmCI,YAAnC,CAAgD,MAAhD,CAAf;AACA,MAAIC,WAAW,SAAXA,QAAW,GAAW;AACzB,OAAIC,iBAAiBf,QAAQS,aAAR,CAAsB,YAAtB,EAAoCO,WAAzD;AACA;AACA;AACA,OAAIC,MAAMF,eAAeG,OAAf,CAAuB,GAAvB,IAA8B,CAAxC;AACA,OAAIC,QAAQJ,eAAeG,OAAf,CAAuB,GAAvB,IAA8B,CAA1C;AACA,OAAIE,SAASL,eAAeM,MAAf,CAAsBF,KAAtB,EAA6BF,MAAME,KAAnC,CAAb;;AAEA,UAAOC,MAAP;AACA,GATD;AAUA,MAAIE,OAAOR,UAAX;AACA,MAAIS,QAAQvB,QAAQS,aAAR,CAAsB,SAAtB,EAAiCe,KAAjC,CAAuCC,OAAnD;;AAEA,MAAIC,WAAW1B,QAAQS,aAAR,CAAsB,eAAtB,EAAuCC,IAAtD;;AAEA,SAAO;AACNF,WAAQA,MADF;AAENmB,SAAMf,QAFA;AAGNgB,YAASN,IAHH;AAINO,cAAWN,KAJL;AAKNO,SAAMnB,SALA;AAMNe,aAAUA;AANJ,GAAP;AAQA,EA3BU,CAAX;AA4BA,QAAOhC,OAAOqC,MAAP,CAAc5B,IAAd,CAAP;AACA;;AAED,SAAS6B,QAAT,CAAkBC,IAAlB,EAAwBC,MAAxB,EAAgC;;AAE/B,KAAIC,MAAMD,SACP,kBADO,GAEP,sBAAsBD,IAAtB,GAA6B,GAA7B,GAAmCC,MAFtC;;AAIA3C,QAAO4B,KAAP,CAAagB,GAAb,EAAkB,YAAW;AAC5B,OAAKC,eAAL,CAAqB,YAArB,EAAmC,YAAW;AAC7C,OAAIC,OAAO,KAAKC,QAAL,CAAcvC,YAAd,EAA4B,EAA5B,CAAX;AACA,UAAQL,SAAS2C,IAAjB;AACA,GAHD;AAIA,EALD;;AAOA9C,QAAOgD,IAAP,CAAY,YAAW;AACtBC,UAAQC,GAAR,CAAYC,KAAKC,SAAL,CAAejD,MAAf,EAAuB,IAAvB,EAA6B,CAA7B,CAAZ;AACA,EAFD;;AAIAH,QAAOqD,GAAP;AACA;;AAEDZ,SAASrC,QAAT,EAAmBG,UAAnB","file":"crawler.js","sourcesContent":["var casper = require(\"casper\").create();\n\nvar tracks = [];\nvar hypeType = casper.cli.get(\"hypeType\");\nvar hypeFilter = casper.cli.get(\"hypeFilter\");\n\n\nfunction getTrackInfo(tracks) {\n\ttracks;\n\tvar element = document.getElementsByClassName(\"section-track\");\n\tvar cool = Array.prototype.map.call(element, function(element) {\n\t\tvar artist = element.querySelector(\".artist\").text;\n\t\tvar trackName = element.querySelector(\".track\").text;\n\t\tvar postLink = element.querySelector(\".readpost\").getAttribute(\"href\");\n\t\tvar descFunc = function() {\n\t\t\tvar descUnfiltered = element.querySelector(\".post_info\").textContent;\n\t\t\t// var regex = /“(?:[^\\\\\"]+|\\\\.)*”/m ;\n\t\t\t// var result = descUnfiltered.match(regex);\n\t\t\tvar end = descUnfiltered.indexOf(\"”\") - 1;\n\t\t\tvar start = descUnfiltered.indexOf(\"“\") + 1;\n\t\t\tvar result = descUnfiltered.substr(start, end - start);\n\n\t\t\treturn result;\n\t\t};\n\t\tvar desc = descFunc();\n\t\tvar color = element.querySelector(\"a.thumb\").style.cssText;\n\n\t\tvar blogName = element.querySelector(\".blog-fav-off\").text;\n\n\t\treturn {\n\t\t\tartist: artist,\n\t\t\tlink: postLink,\n\t\t\tdescrip: desc,\n\t\t\tthumbnail: color,\n\t\t\tsong: trackName,\n\t\t\tblogName: blogName,\n\t\t};\n\t});\n\treturn tracks.concat(cool);\n}\n\nfunction scanHype(type, filter) {\n\n\tvar url = filter\n\t\t? \"http://hypem.com\"\n\t\t: \"http://hypem.com/\" + type + \"/\" + filter;\n\n\tcasper.start(url, function() {\n\t\tthis.waitForSelector(\".post_info\", function() {\n\t\t\tvar info = this.evaluate(getTrackInfo, []);\n\t\t\treturn (tracks = info);\n\t\t});\n\t});\n\n\tcasper.then(function() {\n\t\tconsole.log(JSON.stringify(tracks, null, 2));\n\t});\n\n\tcasper.run();\n}\n\nscanHype(hypeType, hypeFilter);\n"]}